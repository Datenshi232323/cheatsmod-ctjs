const C04 = Java.type('net.minecraft.network.play.client.C03PacketPlayer$C04PacketPlayerPosition')
const C06 = Java.type("net.minecraft.network.play.client.C03PacketPlayer$C06PacketPlayerPosLook")
disablelagback = false
register("tick", (elapsed) => {
    if (elapsed % 41 == 40) {
        for(let i = -1; i <= 1; i++) {
        Client.sendPacket(new C04(Player.getX(), Player.getY() + i, Player.getZ(), Player.getPlayer().field_70122_E))
        }
        disablelagback = true
    } else if(elapsed % 41 == 20) {
        disablelagback = false
    }
})
register("packetReceived", (packet, event) => {
    if (packet.class.getSimpleName() === "S08PacketPlayerPosLook" && disablelagback) {
        cancel(event)
        Client.sendPacket(new C06(packet.func_148932_c(), packet.func_148928_d(), packet.func_148933_e(), packet.func_148931_f(), packet.func_148930_g(), Player.getPlayer().field_70122_E))
        disablelagback = false
    }
})
/*
const C04 = Java.type('net.minecraft.network.play.client.C03PacketPlayer$C04PacketPlayerPosition')
const C06 = Java.type("net.minecraft.network.play.client.C03PacketPlayer$C06PacketPlayerPosLook")
let LastPosX = "null"
let LastPosY = "null"
let LastPosZ = "null"
register("tick", (elapsed) => {
    if (elapsed % 17 > 15) {
        Client.sendPacket(new C04(Player.getX(), -4, Player.getZ(), Player.getPlayer().field_70122_E))
    }
})
register("packetReceived", (packet, event) => {
    if (packet.class.getSimpleName() === "S08PacketPlayerPosLook") {
        if (Player.getPlayer().field_70122_E && !Math.floor(packet.func_148932_c()).toString().includes(LastPosX.toString()) && !Math.floor(packet.func_148928_d()).toString().includes(LastPosY.toString()) && !Math.floor(packet.func_148933_e()).toString().includes(LastPosZ.toString())) {
            cancel(event)
            LastPosX = Math.floor(packet.func_148932_c())
            LastPosY = Math.floor(packet.func_148928_d())
            LastPosZ = Math.floor(packet.func_148933_e())
            Client.sendPacket(new C06(packet.func_148932_c(), packet.func_148928_d(), packet.func_148933_e(), packet.func_148931_f(), packet.func_148930_g(), Player.getPlayer().field_70122_E))
        }
    } else {
        LastPosX = "null"
        LastPosY = "null"
        LastPosZ = "null"
    }
})
*/